#!/data/data/com.termux/files/usr/bin/bash
# ุณูุฑูุจุช ุชูุธูู RAM ุฐูู ูู Termux

# ุงููุฏุฉ ุจุงูุซูุงูู ุจูู ูู ุชูุธูู
INTERVAL=300

# ูุณุจุฉ RAM ุงููุณุชูููุฉ ููุชุทุจููุงุช ุงูุซูููุฉ (ูุซุงู: 10% = 10)
THRESHOLD=10

echo "๐น ุชูุธูู RAM ุฐูู ูู $INTERVAL ุซุงููุฉ"

while true; do
    echo "โณ ุชูุธูู RAM ุฌุงุฑู..."

    # ุชูุฑูุบ ุฃู ุจูุงูุงุช ูุคูุชุฉ ุนูู ุงูุชุฎุฒูู
    sync

    # ูุญุงููุฉ ุชูุฑูุบ ุงููุงุด ุฅุฐุง ูุงู root
    if [ "$(id -u)" -eq 0 ]; then
        echo 3 > /proc/sys/vm/drop_caches
        echo "โ RAM ุชู ุชูุธูููุง ุจุงููุงูู."
    else
        echo "โ๏ธ ุตูุงุญูุงุช root ุบูุฑ ูุชุงุญุฉ. ุชูุธูู ุงููุงุด ูุญุฏูุฏ."
    fi

    # ุนุฑุถ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ
    free -h

    # ูุดู ุงูุนูููุงุช ุงูุซูููุฉ
    echo "๐ ุงูุชุทุจููุงุช ุงูุซูููุฉ:"
    ps -eo pid,pmem,comm --sort=-pmem | head -n 10 | awk -v threshold=$THRESHOLD '$2>threshold {print $0}'

    # ุฅุดุนุงุฑ ุตุบูุฑ (ุฅุฐุง Termux ูุฏุนู ุงูุตูุช)
    echo -e "\a"

    echo "โฑ๏ธ ุงูุงูุชุธุงุฑ $INTERVAL ุซุงููุฉ ูุจู ุงูุชูุธูู ุงูุชุงูู..."
    sleep $INTERVAL
done
